jQuery(function(t){function i(){var i=t("select#product-type").val(),e=n.find(".subscription_scheme").length;"subscription"!==i&&"variable-subscription"!==i&&(e>0?t(".subscription_one_time_shipping").show():t(".subscription_one_time_shipping").hide())}function e(){n.find(".subscription_scheme").each(function(i,e){t(".position",e).val(parseInt(t(e).index(".subscription_schemes .subscription_scheme")))})}var s=t("#wcsatt_data"),n=s.find(".subscription_schemes"),c={message:null,overlayCSS:{background:""!==wcsatt_admin_params.post_id?"#fff":"#f1f1f1",opacity:.6}};t.fn.wcsatt_scripts=function(){t(this).find(".help_tip, .tips, .woocommerce-help-tip").tipTip({attribute:"data-tip",fadeIn:50,fadeOut:50,delay:200})},t.fn.wcsatt_refresh_scheme_lengths=function(){var i=t(this).find(".wc_input_subscription_length"),e=t(this).find(".wc_input_subscription_period"),s=t(this).find(".wc_input_subscription_period_interval"),n=i.val(),c=parseInt(s.val()),o=!1;i.empty(),t.each(wcsatt_admin_params.subscription_lengths[e.val()],function(e,s){0!=parseInt(e)&&0!=parseInt(e)%c||i.append(t("<option></option>").attr("value",e).text(s))}),i.children("option").each(function(){if(this.value==n)return o=!0,!1}),o?i.val(n):i.val(0)},""===wcsatt_admin_params.post_id&&(s.on("click","h3",function(){var i=t(this).closest(".wc-metabox"),e=i.find(".wc-metabox-content");i.hasClass("closed")?e.show():e.hide(),i.toggleClass("closed")}),s.find(".wc-metabox").each(function(){var i=t(this),e=i.find(".wc-metabox-content");i.hasClass("closed")&&e.hide()})),s.on("woocommerce_subscription_schemes_changed",function(){i()}),t("select#product-type").change(function(){i()}).change(),n.on("change","select.subscription_pricing_method_input",function(){var i=t(this).val();t(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method").hide(),t(this).closest(".subscription_scheme_product_data").find(".subscription_pricing_method_"+i).show()}),n.find("select.subscription_pricing_method_input").change(),s.find("input#_wcsatt_force_subscription").on("change",function(){t(this).is(":checked")?s.find(".wcsatt_default_status").hide():s.find(".wcsatt_default_status").show()}).change(),n.on("change",".wc_input_subscription_period",function(){t(this).closest(".subscription_scheme").wcsatt_refresh_scheme_lengths()}),s.on("click","span.scheme-remove",function(){var i=t(this).closest(".subscription_scheme");return i.find("*").off(),i.remove(),e(),s.trigger("woocommerce_subscription_schemes_changed"),!1}),s.on("click",".expand_all",function(){return n.find(".wc-metabox > .wc-metabox-content").show(),!1}),s.on("click",".close_all",function(){return n.find(".wc-metabox > .wc-metabox-content").hide(),!1});var o=s.find(".wc-metabox").length;s.on("click","button.add_subscription_scheme",function(){s.block(c),o++;var i={action:"wcsatt_add_subscription_scheme",post_id:wcsatt_admin_params.post_id,index:o,security:wcsatt_admin_params.add_subscription_scheme_nonce};return t.post(wcsatt_admin_params.wc_ajax_url,i,function(i){n.append(i.markup);var c=n.find(".subscription_scheme").last();c.wcsatt_scripts(),t("input#_virtual").change(),c.find("select.subscription_pricing_method_input").change(),e(),s.unblock(),s.trigger("woocommerce_subscription_scheme_added",i),s.trigger("woocommerce_subscription_schemes_changed")},"json"),!1}),function(){var i=n.find(".subscription_scheme").get();i.sort(function(i,e){var s=parseInt(t(i).attr("rel")),n=parseInt(t(e).attr("rel"));return s<n?-1:s>n?1:0}),t(i).each(function(t,i){n.append(i)}),n.sortable({items:".subscription_scheme",cursor:"move",axis:"y",handle:"span.scheme-handle",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65,placeholder:"wc-metabox-sortable-placeholder",start:function(t,i){i.item.css("background-color","#f6f6f6")},stop:function(t,i){i.item.removeAttr("style"),e()}})}()});